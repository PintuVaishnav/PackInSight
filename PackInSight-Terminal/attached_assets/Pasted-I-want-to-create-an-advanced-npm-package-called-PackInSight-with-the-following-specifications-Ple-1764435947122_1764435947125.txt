I want to create an advanced npm package called "PackInSight" with the following specifications. Please generate the full Node.js project with modular, production-ready code.

**Package Overview:**
- Name: PackInSight
- Purpose: CLI tool that scans npm packages or Node.js projects locally and provides AI-powered suggestions and recommendations for dependency security and best practices.
- Should run fully locally, but can optionally integrate with an AI API (like OpenAI) for human-readable insights.
- CLI should be user-friendly, clear, and modular.

**Functional Requirements:**
1. **CLI Usage:**
   - Command: `packinsight scan <package-name>` or `packinsight scan <path-to-project>`
   - Flags:
     - `--json` : outputs results in JSON format
     - `--dry-run` : scans without installing or modifying anything
     - `--safe-install` : optionally wraps `npm install` to enforce safe installation

2. **Dependency Analysis:**
   - Read `package.json`, `package-lock.json`, and optionally `yarn.lock`.
   - For each dependency:
     - Fetch npm registry metadata: latest version, download count, creation date, author/maintainers, repository URL, license, tags.
     - Detect `preinstall` and `postinstall` scripts.
     - Check known vulnerabilities via public sources (npm advisories, Snyk API, or other public CVEs).
     - Analyze heuristics for risk scoring:
       - Low download count
       - Very new package or version
       - No README or license
       - Suspicious repository or author
       - Name similarity to popular packages (typosquatting)
   - Generate risk levels: Low / Medium / High.

3. **AI-Powered Recommendations:**
   - For each package, produce human-readable suggestions:
     - Summarize the risk and explain why itâ€™s risky.
     - Suggest safer alternative packages if available.
     - Warn about typosquatting, unusual scripts, missing license, or recently published suspicious packages.
   - AI output should be concise (1-3 sentences per package).

4. **Output:**
   - Terminal table or tree view showing:
     - Package name
     - Version
     - Risk score
     - AI recommendation
   - Optional JSON output for CI/CD or automation pipelines.

5. **Project Structure:**
   - Modular code:
     - `scanner.js` : scans dependencies and gathers metadata
     - `analyzer.js` : runs heuristic risk analysis
     - `ai.js` : generates AI-based recommendations
     - `reporter.js` : formats output for terminal or JSON
     - `cli.js` : main CLI entry point
   - Include `package.json`, README.md, LICENSE (MIT recommended), and basic test folder with sample tests.
   - Use minimal dependencies: e.g., `axios` for HTTP requests, `chalk` for terminal colors, `ora` for spinners, optional `openai` SDK for AI integration.

6. **CLI UX:**
   - Use colors to indicate risk: red = high, yellow = medium, green = low.
   - Show a spinner while scanning.
   - Show clear summary at the end with total high/medium/low risk packages.

7. **Deployment Ready:**
   - Include `bin` entry in `package.json` so CLI can be installed globally.
   - Provide npm publish-ready project structure.
   - Include instructions for running locally: `npm install -g .` and then `packinsight scan <package>`

8. **Optional Features:**
   - Full dependency tree scan including transitive dependencies.
   - Integration with CI/CD (GitHub Actions) to auto-scan `package.json` on pull requests.
   - Caching of npm metadata to reduce repeated network calls.
   - Config file support for user-defined thresholds (e.g., low download threshold, max package age, AI suggestion toggle).

**Deliverables:**
- Complete Node.js project folder structure with all modules implemented.
- Example `cli.js` showing how to run the scanner and print results.
- Working AI integration using OpenAI or any local LLM for suggestions.
- Readme with installation and usage instructions.
- Ready to publish to npm registry.

Please generate **production-ready code**, fully functional with comments explaining key logic.
